import random

import matplotlib.pyplot as plt
import numpy as np
from geatpy.benchmarks.mops import dtlz, zdt, wfg, uf


def draw_pareto_2D(name, CC_obj, Proposal_obj, G_obj, DG_obj, LIMD_obj, ref):

    font_title = {'size': 18}
    font = {'size': 16}

    plt.title("Pareto Front of " + name, font_title)
    plt.xlabel("$f_1$", font)
    plt.ylabel("$f_2$", font)
    plt.scatter(CC_obj[:, 0], CC_obj[:, 1], marker="o", label="CC_NSGA3")
    plt.scatter(G_obj[:, 0], G_obj[:, 1], marker="v", label="CC_NSGA3_G")
    plt.scatter(DG_obj[:, 0], DG_obj[:, 1], marker="^", label="CC_NSGA3_DG")
    plt.scatter(LIMD_obj[:, 0], LIMD_obj[:, 1], marker="+", label="CC_NSGA3_LIMD")
    plt.scatter(Proposal_obj[:, 0], Proposal_obj[:, 1], marker="*", label="CC_NSGA3_LINC-Rmin")
    plt.scatter(ref[:, 0], ref[:, 1], marker="<", label="Reference")
    plt.legend()
    plt.show()


def draw_pareto_3D(name, CC_obj, Proposal_obj, G_obj, DG_obj, LIMD_obj, ref):

    font_title = {'size': 18}
    font = {'size': 16}

    ax = plt.subplot(projection='3d')  # 创建一个三维的绘图工程
    ax.set_title("Pareto Front of " + name, font_title)  # 设置本图名称

    ax.scatter(CC_obj[:, 0], CC_obj[:, 1], marker="o", label="CC_NSGA3")
    ax.scatter(DG_obj[:, 0], DG_obj[:, 1], DG_obj[:, 2], marker="^", label="CC_NSGA3_DG")
    ax.scatter(G_obj[:, 0], G_obj[:, 1], G_obj[:, 2], marker="v", label="CC_NSGA3_G")
    ax.scatter(LIMD_obj[:, 0], LIMD_obj[:, 1], LIMD_obj[:, 2], marker="+", label="CC_NSGA3_LIMD")
    ax.scatter(Proposal_obj[:, 0], Proposal_obj[:, 1], Proposal_obj[:, 2], marker="*", label="CC_NSGA3_LINC-Rmin")
    ax.scatter(ref[:, 0], ref[:, 1], ref[:, 2], marker="<", label="Reference")

    ax.set_xlabel("$f_1$", font)
    ax.set_ylabel("$f_2$", font)
    ax.set_zlabel("$f_3$", font)

    plt.legend()
    plt.show()


def HV_calculate(objs, ref):
    HVs = 0
    for obj in objs:
        HV = 1
        for i in range(len(obj)):
            HV *= (obj[i] - ref[i])
        HVs += HV
    return abs(HVs / len(objs))


def IDG_calculate(objs, refs):
    IDGs = 0
    for obj in objs:
        IDG = []
        for ref in refs:
            IDG.append(Dis(obj, ref))
        IDGs += min(IDG)
    return IDGs / len(objs)


def Dis(s1, s2):
    dis = 0
    Dim = len(s1)
    for i in range(Dim):
        dis += (s1[i] - s2[i]) ** 2
    return np.sqrt(dis)

Dim = 1000

Problems = [zdt.ZDT1.ZDT1(Dim=Dim), zdt.ZDT2.ZDT2(Dim=Dim), zdt.ZDT3.ZDT3(Dim=Dim), zdt.ZDT4.ZDT4(Dim=Dim),
                zdt.ZDT5.ZDT5(Dim=Dim), zdt.ZDT6.ZDT6(Dim=Dim), dtlz.DTLZ1.DTLZ1(Dim=Dim), dtlz.DTLZ2.DTLZ2(Dim=Dim),
                dtlz.DTLZ3.DTLZ3(Dim=Dim), dtlz.DTLZ4.DTLZ4(Dim=Dim), dtlz.DTLZ5.DTLZ5(Dim=Dim),
                dtlz.DTLZ6.DTLZ6(Dim=Dim), dtlz.DTLZ7.DTLZ7(Dim=Dim), uf.UF1.UF1(Dim=Dim),
                uf.UF2.UF2(Dim=Dim)]

func_num = 2
problem = Problems[func_num]
ref = problem.calReferObjV()

CC_obj = [[0.45738567784428596, -0.05829698728925488],[0.03268318111076951, 0.8777908404166797],[0.20337773449445162, 0.6011407606746317],[0.6540413941409169, -0.39974155545213874],[0.8265456790312332, -0.46878361907671245],[0.060628712501217846, 0.779641280473564],[0.07551892933206435, 0.7544702087538929],[0.1960022331651052, 0.6561605853621498],[0.41522933536931617, 0.22949855788299087],[0.4256078644162583, 0.10495012489683052],[0.8565511494007391, -0.7118804030011857],[0.6203590810903912, -0.09950438172894754],[0.22278874925525802, 0.4547570200315379],[0.4438001789771931, -0.03762395621818169],[0.20866727735847235, 0.5603568710146944],[0.040195763357382716, 0.8464252541135481],[0.24105437910432823, 0.34956742816314706],[0.003863043856967871, 1.0296175893673436],[0.030923767512340192, 0.8849540802726188],[0.2447489551268518, 0.3350158725400668],[0.4370240387506783, 0.0016634480268515124],[0.8358660821217461, -0.6169044488991002],[0.0, 1.0955047546651886],[0.6352235113425523, -0.3068602070057606],[0.21092342375105586, 0.5433964496616426],[0.6240081909093111, -0.15917299077554758],[0.06438694840587354, 0.7714459918040182],[0.1944856767145558, 0.6668842308918119],[0.07919817138463259, 0.7511335176792264],[0.2542003623912815, 0.3155002797495205],[0.02358863367489797, 0.9181133305926612],[0.2288278907204787, 0.41422920918199285],[0.4313848758382758, 0.047463022172279976],[0.8419801187488871, -0.6804647788643168],[0.642169245518744, -0.3668169546127187],[0.8300993679078307, -0.5309791641554039],[0.047861857197129466, 0.8175168630538842],[0.22527280126998345, 0.43759691709472937],[0.18984929084834204, 0.6980797293106107],[0.41026606032753776, 0.2946948001152272],[0.017267000338491042, 0.948670471589009]
]
G_obj = [[0.6740247139511578, 2.438563955121211],[0.101463688093523, 3.399508301399111],[0.1752325586469546, 3.1946537426537946],[0.9331815184989377, 2.129079400556659],[0.09848490945530944, 3.493632014640359],[0.7623079540765388, 2.329628897337341],[0.4505945532502711, 2.7522416362351305],[0.6805988987820975, 2.3933734585561086],[0.042348960917322695, 3.702941203566861],[0.15010148072377827, 3.3215810559068695],[0.8356159723454182, 2.2252044547687286],[0.14800175153899925, 3.3256578175491045],[0.47706951599177005, 2.674130482017193],[0.0932595486835251, 3.4988344457806435],[0.40700496003929976, 2.7709488847207555],[0.7462666037411173, 2.3426253353314075],[0.5997884919195469, 2.510857096401119],[0.3949367190765223, 2.7957326874649397],[0.8476859882799213, 2.215835150055535],[0.0006891755036562254, 4.072411215453144],[0.9736099560156446, 2.1155205894116675],[0.11800821277996977, 3.3617521057433106],[0.9928376199107203, 2.056586986597021],[0.5420603610795516, 2.582811637757402],[0.6565459685946001, 2.457934627320452],[0.020806010757617135, 3.780209898878635],[0.08027725475099706, 3.5430282315229342],[0.003948313728338267, 3.96472608224835],[0.36158148623733655, 2.8961870317606437],[0.30410252775846086, 2.979003746496505],[0.15174300031627166, 3.2900108181520045],[0.0009389618651483673, 4.057223007352808],[0.9390935394174976, 2.124143328756236],[0.3250545349394687, 2.909767027832136],[0.0068318231940416654, 3.9236404092466617],[0.3004325054480588, 2.9943728841828547],[0.0, 4.089870533739182],[0.26672070107531354, 3.043916896801391],[0.5749928414219224, 2.55290811094681],[0.46072905119092783, 2.6945467599800863],[0.6323186755180359, 2.4602236997764346],[0.9097684773684503, 2.1386916563988545],[0.4349038210312008, 2.766063653588024],[0.8765075905461607, 2.1923072515752917],[0.05487867868033583, 3.613508235525433],[0.0673794485589274, 3.6112580671047527],[0.7800540092250036, 2.2416756055213445],[0.39239590719759554, 2.869094988340321],[0.02994994295994132, 3.759898844116441],[0.945735081925761, 2.120206879647916],[0.24215031986323304, 3.1041867495323725],[0.49775877730011486, 2.6700058574819847],[0.04269121589653016, 3.6989335669652634],[0.25794235414856037, 3.084620111582186],[0.01634809559176696, 3.855544606273823],[0.001119646359031336, 3.9820854587868566],[0.012821644351869384, 3.8786247327515717],[0.6099262384538758, 2.5008287945320666],[0.010093339566017066, 3.9040778626955515],[0.5068369957466736, 2.630153280453911],[0.21706873850349184, 3.139497395318932],[0.03492799714216571, 3.723066515978951],[0.754156380967909, 2.337078730917717],[0.04741065741500822, 3.6414831953542275],[0.39482629257843604, 2.863071533400211],[0.01593203585306033, 3.864527129938042]
         ]
DG_obj = [[0.09265878564139696, 2.3116642808672436],[0.06535117931030923, 2.3928313686834066],[0.13705933151881577, 2.1871101528478647],[0.49432185530865186, 1.589288449403859],[0.801902131632486, 1.3097973501440578],[0.32543397250141837, 1.8433170449109453],[0.009438422656228285, 2.6362867176155556],[0.15388466663726355, 2.182363411749787],[0.2366561135655032, 1.940508742704296],[0.03853983148231905, 2.4417594970474226],[0.001989362050248305, 2.7692342510518846],[0.5278923723605649, 1.5808192325757142],[0.6591775832535622, 1.432118789711691],[0.20465725524341263, 2.0411573599269577],[0.5969977389802937, 1.5356774680658032],[0.06712702772973667, 2.3740173882025046],[0.08864660824474867, 2.3389570227828815],[0.036376900457062315, 2.4499318522080205],[0.4369454056341086, 1.6343999085530152],[0.0018583881693336104, 2.799768100093341],[0.3027130364787141, 1.903693176377322],[0.34013125953451373, 1.7899343610747562],[0.26672637961086004, 1.9061866690370581],[0.0, 2.894669751813826],[0.07133040551284364, 2.362474613514875],[0.9886255246549245, 1.121568102049851],[0.1057663722008568, 2.2407191512018225],[0.13010281858400735, 2.1881535484836903],[0.0004681763749126758, 2.80877501884135],[0.8827569655483282, 1.2536411563839536],[0.5647087178967136, 1.5392486370576859],[0.8615461694832856, 1.2664453227122554],[0.4758166959843477, 1.6338953207043647],[0.15422087482985175, 2.129601163854917],[0.03193936180373372, 2.511465302948537],[0.3826899189992701, 1.697446133545141],[0.9392985141450482, 1.1304587737791187],[0.29130167230158105, 1.9058272572394133],[0.6111279125072372, 1.51087520794033],[0.018423086713102114, 2.53229076710868],[0.1582117332947239, 2.1026693402777266],[0.9078703377228091, 1.1880470760073483],[0.9005503485456597, 1.223043455240501],[0.00407994794341515, 2.657281830588368],[0.6790091758559389, 1.3899495179196801],[0.009502484146186622, 2.6153681539273794],[0.2260568233304829, 2.0220507101791814],[0.7469171601672732, 1.3147844914239581],[0.20187554965410992, 2.07886202075209]
          ]
LIMD_obj = [[0.1360810583467416, 3.1899477039467716],[0.6723130228108622, 2.312160150568305],[0.05777859863533236, 3.5337428674997478],[0.00423886552376241, 3.8023665840675216],[0.29174089819442517, 2.8976129925044862],[0.6468158316255455, 2.385296901785326],[0.019049398177182413, 3.6996571125324884],[0.8856767017722892, 2.1024075836425626],[0.3779654182515549, 2.7623712346909675],[0.17613306265444517, 3.1262313846659056],[0.28534838065046814, 2.917480039561736],[0.1866172559331622, 3.0946138813372412],[0.04215511790532589, 3.611309937309593],[0.2822846796763781, 2.954003805874286],[0.5904010188565346, 2.503178107739635],[0.039816266886503665, 3.6298644451446482],[0.49382404330320084, 2.603274403189235],[0.2209431471682296, 3.003854202605954],[0.307968152551336, 2.8130157961910283],[0.4239031220157304, 2.6727639281202342],[0.45763136810639243, 2.6359020163644105],[0.39025152361320115, 2.7432357455505727],[0.5187779736634295, 2.534439119601352],[0.28807298022770245, 2.8996146681267985],[0.10575818822059942, 3.36301211176789],[0.038539915649558554, 3.633747178454329],[0.8329323910889047, 2.1382372794594686],[0.4011368863272465, 2.6939073880098894],[0.028518722412569614, 3.641185390294508],[0.6312532557688374, 2.4127411991398318],[0.08855782056581772, 3.4039087451909467],[0.5384563850146662, 2.532447293853002],[0.9717329078864607, 2.002367957558997],[0.6085225099742804, 2.436870960224316],[0.9680937530262715, 2.0824915980974206],[0.008324384770127103, 3.728968422109422],[0.7858113390725474, 2.2039083880274823],[0.7190747739191482, 2.2484789080706142],[0.06885490310526497, 3.4391753767911384],[0.9114583195739148, 2.0906932214827183],[0.6004956719715459, 2.485186691529652],[0.24543569161280268, 2.978700432767137],[0.0, 3.932923602653831],[0.23952102073828566, 2.9836947324523226],[0.21247418923752712, 3.0598617625150695],[0.0013580101046045132, 3.911671408114883],[0.11202009425351572, 3.3040057689215074],[0.002340755967331186, 3.8489293101239817]
]
Proposal_obj = [[0.37689699279144406, 0.48343007174093544],[0.5852735149674118, 0.3218305730235341],[0.8686157800257206, 0.14377723826694785],[0.11284008198473944, 0.7796652114512501],[0.030956061091274023, 0.9499773222598061],[0.44409776385912036, 0.427597228778027],[0.37148477522144946, 0.48708959730382734],[0.02739980446550121, 0.9621060256281191],[0.44130216636526887, 0.4292909059950745],[0.06270890962332487, 0.8706419615353073],[0.22726558282322912, 0.6295584568127569],[0.061180868415867215, 0.8737341425534437],[0.008345931455906435, 1.0410096694392668],[0.3312932492212216, 0.5238492593339727],[0.9283792048623346, 0.10986130074652214],[0.4320579151118663, 0.437313373028132],[0.29555723598688527, 0.557689135955803],[0.13614931471688374, 0.7444931835279419],[0.9438378200866282, 0.10151686119714715],[0.3345379598205534, 0.5206148760595887],[0.0, 1.1392843473541652],[0.5479319112995906, 0.34759867470002387],[0.5145774536515286, 0.373049278003089],[0.6871955916285515, 0.2534819950665535],[0.20202939213950868, 0.6582701663155524],[0.09912574577324625, 0.80239505538852],[0.05089970506341924, 0.8963665955274441],[0.2873616465367377, 0.5661852522204619],[0.11069606079619886, 0.7833493106604549],[0.04756478135521172, 0.9058947221948714],[0.08384566076287082, 0.8295752169483911],[0.5844808412436503, 0.32257984021226194],[0.0035324580708669976, 1.0743255664739435],[0.6137245943053625, 0.3018859308755519],[0.3263360698040372, 0.5286416427252563],[0.5243927391117024, 0.3660419586452077],[0.8217935747530323, 0.17034472363351186],[0.4188644754137829, 0.44713586087242474],[0.018787828642222074, 0.9919137747789177],[0.7773947979346091, 0.1973326118146623],[0.9513565501331699, 0.09766133318243447],[0.015813823252822882, 1.0042264020840266],[0.7602943591968968, 0.20750947562062208],[0.14203852115171575, 0.7364168021836262],[0.1677282908131323, 0.701139774485371]
                ]

CC_obj = np.array(CC_obj)
G_obj = np.array(G_obj)
DG_obj = np.array(DG_obj)
LIMD_obj = np.array(LIMD_obj)
Proposal_obj = np.array(Proposal_obj)

ref_point = ref[random.randint(0, len(ref))]

CC_HV = HV_calculate(CC_obj, ref_point)
G_HV = HV_calculate(G_obj, ref_point)
DG_HV = HV_calculate(DG_obj, ref_point)
LIMD_HV = HV_calculate(LIMD_obj, ref_point)
Proposal_HV = HV_calculate(Proposal_obj, ref_point)

print("CC HV", CC_HV)
print("G_1000 HV", G_HV)
print("DG_1000 HV", DG_HV)
print("LIMD_1000 HV", LIMD_HV)
print("Proposal_500 HV", Proposal_HV)

CC_IDG = IDG_calculate(CC_obj, ref[0:10])
G_IDG = IDG_calculate(G_obj, ref[0:10])
DG_IDG = IDG_calculate(DG_obj, ref[0:10])
LIMD_IDG = IDG_calculate(LIMD_obj, ref[0:10])
Proposal_IDG = IDG_calculate(Proposal_obj, ref[0:10])

print("CC IDG", CC_IDG)
print("G_1000 IDG", G_IDG)
print("DG_1000 IDG", DG_IDG)
print("LIMD_1000 IDG", LIMD_IDG)
print("Proposal_500 IDG", Proposal_IDG)

if problem.M == 2:
    draw_pareto_2D(problem.name, CC_obj, Proposal_obj, G_obj, DG_obj, LIMD_obj, ref)
if problem.M == 3:
    draw_pareto_3D(problem.name, CC_obj, Proposal_obj, G_obj, DG_obj, LIMD_obj, ref)